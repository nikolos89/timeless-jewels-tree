(function(){"use strict";const v=Symbol("Comlink.proxy"),C=Symbol("Comlink.endpoint"),U=Symbol("Comlink.releaseProxy"),p=Symbol("Comlink.thrown"),S=t=>typeof t=="object"&&t!==null||typeof t=="function",N={canHandle:t=>S(t)&&t[v],serialize(t){const{port1:i,port2:c}=new MessageChannel;return _(t,i),[c,[c]]},deserialize(t){return t.start(),M(t)}},D={canHandle:t=>S(t)&&p in t,serialize({value:t}){let i;return t instanceof Error?i={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:i={isError:!1,value:t},[i,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},j=new Map([["proxy",N],["throw",D]]);function _(t,i=self){i.addEventListener("message",function c(a){if(!a||!a.data)return;const{id:r,type:s,path:o}=Object.assign({path:[]},a.data),l=(a.data.argumentList||[]).map(w);let f;try{const u=o.slice(0,-1).reduce((e,n)=>e[n],t),d=o.reduce((e,n)=>e[n],t);switch(s){case"GET":f=d;break;case"SET":u[o.slice(-1)[0]]=w(a.data.value),f=!0;break;case"APPLY":f=d.apply(u,l);break;case"CONSTRUCT":{const e=new d(...l);f=W(e)}break;case"ENDPOINT":{const{port1:e,port2:n}=new MessageChannel;_(t,n),f=V(e,[e])}break;case"RELEASE":f=void 0;break;default:return}}catch(u){f={value:u,[p]:0}}Promise.resolve(f).catch(u=>({value:u,[p]:0})).then(u=>{const[d,e]=k(u);i.postMessage(Object.assign(Object.assign({},d),{id:r}),e),s==="RELEASE"&&(i.removeEventListener("message",c),P(i))})}),i.start&&i.start()}function L(t){return t.constructor.name==="MessagePort"}function P(t){L(t)&&t.close()}function M(t,i){return x(t,[],i)}function E(t){if(t)throw new Error("Proxy has been released and is not useable")}function x(t,i=[],c=function(){}){let a=!1;const r=new Proxy(c,{get(s,o){if(E(a),o===U)return()=>b(t,{type:"RELEASE",path:i.map(l=>l.toString())}).then(()=>{P(t),a=!0});if(o==="then"){if(i.length===0)return{then:()=>r};const l=b(t,{type:"GET",path:i.map(f=>f.toString())}).then(w);return l.then.bind(l)}return x(t,[...i,o])},set(s,o,l){E(a);const[f,u]=k(l);return b(t,{type:"SET",path:[...i,o].map(d=>d.toString()),value:f},u).then(w)},apply(s,o,l){E(a);const f=i[i.length-1];if(f===C)return b(t,{type:"ENDPOINT"}).then(w);if(f==="bind")return x(t,i.slice(0,-1));const[u,d]=I(l);return b(t,{type:"APPLY",path:i.map(e=>e.toString()),argumentList:u},d).then(w)},construct(s,o){E(a);const[l,f]=I(o);return b(t,{type:"CONSTRUCT",path:i.map(u=>u.toString()),argumentList:l},f).then(w)}});return r}function G(t){return Array.prototype.concat.apply([],t)}function I(t){const i=t.map(k);return[i.map(c=>c[0]),G(i.map(c=>c[1]))]}const O=new WeakMap;function V(t,i){return O.set(t,i),t}function W(t){return Object.assign(t,{[v]:!0})}function k(t){for(const[i,c]of j)if(c.canHandle(t)){const[a,r]=c.serialize(t);return[{type:"HANDLER",name:i,value:a},r]}return[{type:"RAW",value:t},O.get(t)||[]]}function w(t){switch(t.type){case"HANDLER":return j.get(t.name).deserialize(t.value);case"RAW":return t.value}}function b(t,i,c){return new Promise(a=>{const r=B();t.addEventListener("message",function s(o){!o.data||!o.data.id||o.data.id!==r||(t.removeEventListener("message",s),a(o.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:r},i),c)})}function B(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}(()=>{const t=()=>{const a=new Error("not implemented");return a.code="ENOSYS",a};if(!globalThis.fs){let a="";globalThis.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1},writeSync(r,s){a+=c.decode(s);const o=a.lastIndexOf(`
`);return o!=-1&&(console.log(a.substr(0,o)),a=a.substr(o+1)),s.length},write(r,s,o,l,f,u){if(o!==0||l!==s.length||f!==null){u(t());return}const d=this.writeSync(r,s);u(null,d)},chmod(r,s,o){o(t())},chown(r,s,o,l){l(t())},close(r,s){s(t())},fchmod(r,s,o){o(t())},fchown(r,s,o,l){l(t())},fstat(r,s){s(t())},fsync(r,s){s(null)},ftruncate(r,s,o){o(t())},lchown(r,s,o,l){l(t())},link(r,s,o){o(t())},lstat(r,s){s(t())},mkdir(r,s,o){o(t())},open(r,s,o,l){l(t())},read(r,s,o,l,f,u){u(t())},readdir(r,s){s(t())},readlink(r,s){s(t())},rename(r,s,o){o(t())},rmdir(r,s){s(t())},stat(r,s){s(t())},symlink(r,s,o){o(t())},truncate(r,s,o){o(t())},unlink(r,s){s(t())},utimes(r,s,o,l){l(t())}}}if(globalThis.process||(globalThis.process={getuid(){return-1},getgid(){return-1},geteuid(){return-1},getegid(){return-1},getgroups(){throw t()},pid:-1,ppid:-1,umask(){throw t()},cwd(){throw t()},chdir(){throw t()}}),!globalThis.crypto)throw new Error("globalThis.crypto is not available, polyfill required (crypto.getRandomValues only)");if(!globalThis.performance)throw new Error("globalThis.performance is not available, polyfill required (performance.now only)");if(!globalThis.TextEncoder)throw new Error("globalThis.TextEncoder is not available, polyfill required");if(!globalThis.TextDecoder)throw new Error("globalThis.TextDecoder is not available, polyfill required");const i=new TextEncoder("utf-8"),c=new TextDecoder("utf-8");globalThis.Go=class{constructor(){this.argv=["js"],this.env={},this.exit=e=>{e!==0&&console.warn("exit code:",e)},this._exitPromise=new Promise(e=>{this._resolveExitPromise=e}),this._pendingEvent=null,this._scheduledTimeouts=new Map,this._nextCallbackTimeoutID=1;const a=(e,n)=>{this.mem.setUint32(e+0,n,!0),this.mem.setUint32(e+4,Math.floor(n/4294967296),!0)},r=e=>{const n=this.mem.getUint32(e+0,!0),h=this.mem.getInt32(e+4,!0);return n+h*4294967296},s=e=>{const n=this.mem.getFloat64(e,!0);if(n===0)return;if(!isNaN(n))return n;const h=this.mem.getUint32(e,!0);return this._values[h]},o=(e,n)=>{if(typeof n=="number"&&n!==0){if(isNaN(n)){this.mem.setUint32(e+4,2146959360,!0),this.mem.setUint32(e,0,!0);return}this.mem.setFloat64(e,n,!0);return}if(n===void 0){this.mem.setFloat64(e,0,!0);return}let m=this._ids.get(n);m===void 0&&(m=this._idPool.pop(),m===void 0&&(m=this._values.length),this._values[m]=n,this._goRefCounts[m]=0,this._ids.set(n,m)),this._goRefCounts[m]++;let g=0;switch(typeof n){case"object":n!==null&&(g=1);break;case"string":g=2;break;case"symbol":g=3;break;case"function":g=4;break}this.mem.setUint32(e+4,2146959360|g,!0),this.mem.setUint32(e,m,!0)},l=e=>{const n=r(e+0),h=r(e+8);return new Uint8Array(this._inst.exports.mem.buffer,n,h)},f=e=>{const n=r(e+0),h=r(e+8),m=new Array(h);for(let g=0;g<h;g++)m[g]=s(n+g*8);return m},u=e=>{const n=r(e+0),h=r(e+8);return c.decode(new DataView(this._inst.exports.mem.buffer,n,h))},d=Date.now()-performance.now();this.importObject={go:{"runtime.wasmExit":e=>{e>>>=0;const n=this.mem.getInt32(e+8,!0);this.exited=!0,delete this._inst,delete this._values,delete this._goRefCounts,delete this._ids,delete this._idPool,this.exit(n)},"runtime.wasmWrite":e=>{e>>>=0;const n=r(e+8),h=r(e+16),m=this.mem.getInt32(e+24,!0);fs.writeSync(n,new Uint8Array(this._inst.exports.mem.buffer,h,m))},"runtime.resetMemoryDataView":e=>{this.mem=new DataView(this._inst.exports.mem.buffer)},"runtime.nanotime1":e=>{e>>>=0,a(e+8,(d+performance.now())*1e6)},"runtime.walltime":e=>{e>>>=0;const n=new Date().getTime();a(e+8,n/1e3),this.mem.setInt32(e+16,n%1e3*1e6,!0)},"runtime.scheduleTimeoutEvent":e=>{e>>>=0;const n=this._nextCallbackTimeoutID;this._nextCallbackTimeoutID++,this._scheduledTimeouts.set(n,setTimeout(()=>{for(this._resume();this._scheduledTimeouts.has(n);)console.warn("scheduleTimeoutEvent: missed timeout event"),this._resume()},r(e+8)+1)),this.mem.setInt32(e+16,n,!0)},"runtime.clearTimeoutEvent":e=>{e>>>=0;const n=this.mem.getInt32(e+8,!0);clearTimeout(this._scheduledTimeouts.get(n)),this._scheduledTimeouts.delete(n)},"runtime.getRandomData":e=>{e>>>=0,crypto.getRandomValues(l(e+8))},"syscall/js.finalizeRef":e=>{e>>>=0;const n=this.mem.getUint32(e+8,!0);if(this._goRefCounts[n]--,this._goRefCounts[n]===0){const h=this._values[n];this._values[n]=null,this._ids.delete(h),this._idPool.push(n)}},"syscall/js.stringVal":e=>{e>>>=0,o(e+24,u(e+8))},"syscall/js.valueGet":e=>{e>>>=0;const n=Reflect.get(s(e+8),u(e+16));e=this._inst.exports.getsp()>>>0,o(e+32,n)},"syscall/js.valueSet":e=>{e>>>=0,Reflect.set(s(e+8),u(e+16),s(e+32))},"syscall/js.valueDelete":e=>{e>>>=0,Reflect.deleteProperty(s(e+8),u(e+16))},"syscall/js.valueIndex":e=>{e>>>=0,o(e+24,Reflect.get(s(e+8),r(e+16)))},"syscall/js.valueSetIndex":e=>{e>>>=0,Reflect.set(s(e+8),r(e+16),s(e+24))},"syscall/js.valueCall":e=>{e>>>=0;try{const n=s(e+8),h=Reflect.get(n,u(e+16)),m=f(e+32),g=Reflect.apply(h,n,m);e=this._inst.exports.getsp()>>>0,o(e+56,g),this.mem.setUint8(e+64,1)}catch(n){e=this._inst.exports.getsp()>>>0,o(e+56,n),this.mem.setUint8(e+64,0)}},"syscall/js.valueInvoke":e=>{e>>>=0;try{const n=s(e+8),h=f(e+16),m=Reflect.apply(n,void 0,h);e=this._inst.exports.getsp()>>>0,o(e+40,m),this.mem.setUint8(e+48,1)}catch(n){e=this._inst.exports.getsp()>>>0,o(e+40,n),this.mem.setUint8(e+48,0)}},"syscall/js.valueNew":e=>{e>>>=0;try{const n=s(e+8),h=f(e+16),m=Reflect.construct(n,h);e=this._inst.exports.getsp()>>>0,o(e+40,m),this.mem.setUint8(e+48,1)}catch(n){e=this._inst.exports.getsp()>>>0,o(e+40,n),this.mem.setUint8(e+48,0)}},"syscall/js.valueLength":e=>{e>>>=0,a(e+16,parseInt(s(e+8).length))},"syscall/js.valuePrepareString":e=>{e>>>=0;const n=i.encode(String(s(e+8)));o(e+16,n),a(e+24,n.length)},"syscall/js.valueLoadString":e=>{e>>>=0;const n=s(e+8);l(e+16).set(n)},"syscall/js.valueInstanceOf":e=>{e>>>=0,this.mem.setUint8(e+24,s(e+8)instanceof s(e+16)?1:0)},"syscall/js.copyBytesToGo":e=>{e>>>=0;const n=l(e+8),h=s(e+32);if(!(h instanceof Uint8Array||h instanceof Uint8ClampedArray)){this.mem.setUint8(e+48,0);return}const m=h.subarray(0,n.length);n.set(m),a(e+40,m.length),this.mem.setUint8(e+48,1)},"syscall/js.copyBytesToJS":e=>{e>>>=0;const n=s(e+8),h=l(e+16);if(!(n instanceof Uint8Array||n instanceof Uint8ClampedArray)){this.mem.setUint8(e+48,0);return}const m=h.subarray(0,n.length);n.set(m),a(e+40,m.length),this.mem.setUint8(e+48,1)},debug:e=>{console.log(e)}}}}async run(a){if(!(a instanceof WebAssembly.Instance))throw new Error("Go.run: WebAssembly.Instance expected");this._inst=a,this.mem=new DataView(this._inst.exports.mem.buffer),this._values=[NaN,0,null,!0,!1,globalThis,this],this._goRefCounts=new Array(this._values.length).fill(1/0),this._ids=new Map([[0,1],[null,2],[!0,3],[!1,4],[globalThis,5],[this,6]]),this._idPool=[],this.exited=!1;let r=4096;const s=e=>{const n=r,h=i.encode(e+"\0");return new Uint8Array(this.mem.buffer,r,h.length).set(h),r+=h.length,r%8!==0&&(r+=8-r%8),n},o=this.argv.length,l=[];this.argv.forEach(e=>{l.push(s(e))}),l.push(0),Object.keys(this.env).sort().forEach(e=>{l.push(s(`${e}=${this.env[e]}`))}),l.push(0);const u=r;l.forEach(e=>{this.mem.setUint32(r,e,!0),this.mem.setUint32(r+4,0,!0),r+=8});const d=4096+8192;if(r>=d)throw new Error("total length of command line and environment variables exceeds limit");this._inst.exports.run(o,u),this.exited&&this._resolveExitPromise(),await this._exitPromise}_resume(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}_makeFuncWrapper(a){const r=this;return function(){const s={id:a,this:this,args:arguments};return r._pendingEvent=s,r._resume(),s.result}}}})(),Promise.resolve();let R,T;const H=()=>{R={Calculate:globalThis.go["timeless-jewels"].calculator.Calculate,ReverseSearch:globalThis.go["timeless-jewels"].calculator.ReverseSearch},T={GetAlternatePassiveAdditionByIndex:globalThis.go["timeless-jewels"].data.GetAlternatePassiveAdditionByIndex,GetAlternatePassiveSkillByIndex:globalThis.go["timeless-jewels"].data.GetAlternatePassiveSkillByIndex,GetPassiveSkillByIndex:globalThis.go["timeless-jewels"].data.GetPassiveSkillByIndex,GetStatByIndex:globalThis.go["timeless-jewels"].data.GetStatByIndex,PassiveSkills:globalThis.go["timeless-jewels"].data.PassiveSkills,PassiveTranslations:globalThis.go["timeless-jewels"].data.PassiveTranslations,PossibleStats:globalThis.go["timeless-jewels"].data.PossibleStats,SkillTree:globalThis.go["timeless-jewels"].data.SkillTree,TimelessJewelConquerors:globalThis.go["timeless-jewels"].data.TimelessJewelConquerors,TimelessJewelSeedRanges:globalThis.go["timeless-jewels"].data.TimelessJewelSeedRanges,TimelessJewels:globalThis.go["timeless-jewels"].data.TimelessJewels,TreeToPassive:globalThis.go["timeless-jewels"].data.TreeToPassive}};let y;const A={},J=()=>{y=JSON.parse(T.SkillTree),console.log("Loaded skill tree",y),Object.keys(y.groups).forEach(i=>{y.groups[i].nodes.forEach(a=>{const r=y.nodes[a];r.isProxy||"classStartIndex"in r||r.expansionJewel&&r.expansionJewel.parent||r.isBlighted||r.ascendancyName})}),y.skillSprites.keystoneInactive.forEach(i=>Object.keys(i.coords).forEach(c=>i)),y.skillSprites.notableInactive.forEach(i=>Object.keys(i.coords).forEach(c=>i)),y.skillSprites.normalInactive.forEach(i=>Object.keys(i.coords).forEach(c=>i)),y.skillSprites.masteryInactive.forEach(i=>Object.keys(i.coords).forEach(c=>i)),y.skillSprites.keystoneActive.forEach(i=>Object.keys(i.coords).forEach(c=>i)),y.skillSprites.notableActive.forEach(i=>Object.keys(i.coords).forEach(c=>i)),y.skillSprites.normalActive.forEach(i=>Object.keys(i.coords).forEach(c=>i)),y.skillSprites.masteryInactive.forEach(i=>Object.keys(i.coords).forEach(c=>i)),JSON.parse(T.PassiveTranslations).forEach(i=>{i.ids.forEach(c=>{})}),Object.keys(T.TreeToPassive).forEach(i=>{A[T.TreeToPassive[parseInt(i)].Index]=parseInt(i)})};_({boot(t){const i=new Go;WebAssembly.instantiate(t,i.importObject).then(c=>{i.run(c.instance),H(),J()})},search(t,i){const c=R.ReverseSearch(t.nodes,t.stats.map(r=>r.id),t.jewel,t.conqueror,i),a={};return Object.keys(c).forEach(r=>{const s=parseInt(r);let o=0;const l={},f=Object.keys(c[s]).map(d=>{const e=parseInt(d);return Object.keys(c[s][e]).forEach(n=>{var m;const h=parseInt(n);l[h]=(l[h]||0)+1,o+=((m=t.stats.find(g=>g.id==h))==null?void 0:m.weight)||0}),{passive:A[e],stats:c[s][e]}}),u=Object.keys(c[s]).length;a[u]=[...a[u]||[],{skills:f,seed:s,weight:o,statCounts:l}]}),Object.keys(a).forEach(r=>{const s=parseInt(r);a[s]=a[s].filter(o=>{if(o.weight<t.minTotalWeight)return!1;for(const l of t.stats)if(o.statCounts[l.id]===void 0&&l.min>0||o.statCounts[l.id]<l.min)return!1;return!0}),Object.keys(a[s]).length==0?delete a[s]:a[s]=a[s].sort((o,l)=>l.weight-o.weight)}),{grouped:a,raw:Object.keys(a).map(r=>a[parseInt(r)]).flat().sort((r,s)=>s.weight-r.weight)}}})})();
